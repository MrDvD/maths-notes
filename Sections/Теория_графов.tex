\section{Теория графов}

\subsection{Ориентированный граф}

{\bold Граф} {\ital (ориентированный граф или орграф)} --- упорядо"=ченная пара $G=\langle V,E\rangle$, где

$V$ --- непустое множество {\ital вершин {\color{desc}(узлов)}};\\
$E$ --- конечное множество {\ital рёбер}, $E\subseteq V\times V$.

{\ital Порядок} графа $G$ --- число его вершин $n=\abs{V}$.

{\ital Размер} графа $G$ --- число его рёбер $m=\abs{E}$.

Ребро $e=\langle v,\ w\rangle$ задаётся вершинами $v,\ w$, где $v$ --- начало ребра, а $w$ --- его конец; вершины $v,\ w$ являются {\ital соседними}.

{\ital Входящая валентность} вершины $v$ графа $G$ --- число рёбер, чей конец в $v$:
% ---
$$\text{indeg}(v)=\abs{\{\langle u,v\rangle\mid\langle u,v\rangle\in E\}}$$
% ---
{\ital Исходящая валентность} вершины $v$ графа $G$ --- число рёбер, чьё начало в $v$:
% ---
$$\text{outdeg}(v)=\abs{\{\langle v,u\rangle\mid\langle v,u\rangle\in E\}}$$
% ---
{\ital Валентность} вершины $v$ графа $G$ --- сумма входящей и исхо"=дящей валентностей вершины:
% ---
$$\text{deg}(v)=\text{indeg}(v)+\text{outdeg}(v)$$
% ---
{\ital Свойство.} Пусть $G=\langle V,E\rangle$ --- граф с $n$ вершинами и $m$ рёб"=рами, причём $V=\{v_1,\dots,v_n\}$. Тогда:
% ---
$$\sum_{i=1}^{n}\text{indeg}(v_i)=\sum_{i=1}^{n}\text{outdeg}(v_i)=m$$
% ---
{\ital Подграф} $G=\langle V,E\rangle$, {\ital порождённый} на $W\subset V$, --- граф вида
% ---
$$G_W=\langle W,E\cap W\times W\rangle.$$

\newpage
\subsection{Последовательность вершин}

{\bold Путь} от вершины $v_i$ до вершины $v_j$ графа $G$ --- последо"=вательность вершин или рёбер:
% ---
$$\begin{cases}
\begin{sqcases}
[v_i,v_{i+1},\dots,v_{j-1},v_j]\text{ вершины}\\
[e_i,e_{i+1},\dots,e_{j-1},e_j]\text{ рёбра}
\end{sqcases}\\
e_k=\langle v_{k-1},v_k\rangle,k\in\{i+1,\dots,j\}
\end{cases}$$
% ---
{\bold Закрытым} называется такой путь, где начальная и~конечная вершины совпадают.

{\bold Цепь} --- путь без повтора рёбер.

{\bold Простая цепь} --- путь без повтора рёбер и вершин {\ital\color{desc} (кроме, возможно, первой и~последней вершины)}.

{\bold Цикл} --- закрытая простая цепь.

{\bold Эйлеровой} называется такая последовательность вершин, которая проходит {\ital по всем} вершинам графа.
% ---
\begin{theorem}
{\bold Критерий эйлеровости.} Связный граф {\ital эйлеров}, если валентность всех его вершин чётна. 
\end{theorem}
% ---
{\bold Ациклическим {\ital (лесом)}} называется граф без циклов.

\subsection{Неориентированный граф}

{\bold Неорграф} {\ital (неориентированный граф)} --- такой граф $G=\langle V,E\rangle$, что:
% ---
$$\forall v,w\in V\ \langle v,w\rangle\in E\implies\langle w,v\rangle\in E$$
% ---
{\bold Валентность} вершины $v$ неорграфа --- число рёбер, которые связаны с $v$.

\subsection{Связность графа}

{\bold Связный:}
% ---
\begin{list*}
\item{\ital неорграф}, между любыми вершинами которого есть маршрут;
\item{\ital орграф}, у которого аналогичный неорграф {\ital связный}.
\end{list*}
% ---
{\bold Сильно связным} называется такой {\ital орграф} $G=\langle V,E\rangle$, что:
% ---
$$\forall v,w\in V\ \exists
\begin{cases}
\text{маршрут от }v\text{ до }w\\
\text{маршрут от }w\text{ до }v
\end{cases}$$
% ---
{\bold Компонент связности} {\ital неорграфа} --- связный подграф, который не входит в состав такого же подграфа.

{\bold Компонент сильной связности} {\ital орграфа} --- сильно связный подграф, который не входит в состав такого же подграфа.

\subsection{Виды неориентированных графов}

Неориентированный граф $G=\langle V,E\rangle=:K_n,\ n=\abs{V}$ называ"=ется {\ital полным}, если $\forall v,w\in V,v\neq w\ \langle v,w\rangle\in E$.

Неориентированный граф $G=\langle V,E\rangle$ называется {\ital однород"=ным}, если $\forall v,w\in V\ \text{deg}(v)=\text{deg}(w)$.

\subsection{Свободное дерево}

{\bold Дерево} {\ital (свободное)} --- компонент связности леса $T=\langle V,E\rangle$.

{\ital Свойство.} Пусть $T=\langle V,E\rangle$. Тогда $\abs{E}=\abs{V}-1$.

{\ital Поддерево $T=\langle V,E\rangle$, порождённое} на $W\subset V$, --- дерево вида:
% ---
$$T_W=\langle W,E\cap W\times W\rangle$$

\subsection{Корневое дерево}

{\bold Корневое дерево} {\ital (ориентированное дерево или ордерево)} --- такой орграф, у которого:
% ---
\begin{list*}
\item аналогичный неорграф есть свободное дерево;
\item есть {\bold корень} --- единственная вершина с нулевой входя"=щей валентностью.
\end{list*}
% ---
Пусть $T=\langle V,E\rangle$ --- дерево, $\langle v,w\rangle\in E$:
% ---
\begin{tabularcx}{0pt}{5pt}{L @{\quad} L}{\textwidth}
$v=:$ parent$_w$ --- {\ital родитель} вершины $w$. & $w\in$ children$_v$ --- {\ital ребёнок} вершины $v$.\\
{\ital Корневым} называется узел без родителей. & {\ital Листовым} называется узел без детей.
\end{tabularcx}

{\ital Сиблинги} --- вершины с общими родителями.

{\ital Первый} в памяти ребёнок узла $v$ --- first$_v$, {\ital последний} --- $\text{last}_v$; {\ital следующий} в памяти родственник узла $v$ --- next$_v$.

{\ital Уровень} вершины $v$ дерева $T$ --- длина простой цепи от root$_T$ до $v$; обозначается depth$_v$.

\subsection{Способы представления графа}

{\bold Матрица смежности} для $G=\langle V,E\rangle$ --- булева матрица $V^2$, элементы которой равны логическому значению выражения:
% ---
$$\langle v,w\rangle\in E\mid v,w\in V$$
% ---
Матрица занимает $\mathcal{O}(V^2)$ места; проверка смежности прохо"=дит за $\mathcal{O}(1)$.

{\bold Список смежности} --- хеш-таблица вида:
% ---
$$\text{вершина }\mapsto\text{ смежные узлы}$$
% ---
Список занимает $\mathcal{O}(\abs{V}+\abs{E})$ места; проверка смежности проходит за $\mathcal{O}(\text{outdeg}(v))$.

\subsection{Способы представления дерева}

{\bold Массив родителей} --- хеш-таблица вида:
% ---
$$v\mapsto\text{children}_v$$
% ---
Массив занимает $\mathcal{O}(\abs{V})$ места; вывод родителя и порядка дерева проходят за $\mathcal{O}(1)$.

{\bold «Первый ребёнок, следующий сиблинг»} --- хеш-таблица вида:
% ---
$$v\mapsto\langle\text{first}_v,\text{next}_v\rangle$$
% ---
Массив занимает $\mathcal{O}(\abs{V})$ места; вывод первого ребёнка, следу"=ющего родственника и порядка дерева проходят за $\mathcal{O}(1)$.

\subsection{Редактирование дерева}

К {\bold элементарным операциям} редактирования дерева относятся:

--- {\ital удаление} листового узла $v$ с ребром $\langle\text{parent}_v,v\rangle$: $v\mapsto\lambda$;\\
--- {\ital вставка} листового узла $v$ с ребром $\langle\text{parent}_v,v\rangle$: $\lambda\mapsto v$;\\
--- {\ital замещение} вершины $v$ другой вершиной $w$: $v\mapsto w$.

Пусть $T_1=\langle V_1,E_1\rangle$, $T_2=\langle V_2,E_2\rangle$ --- корневые деревья.

{\ital Трансформация} $T_1$ в $T_2$ --- упорядоченное биективное отображение $E\subseteq V_1\cup\{\lambda\}\times V_2\cup\{\lambda\}$.

Биективное {\ital отображение} $T_1$ в $T_2$ --- такое $M\subseteq W_1\times W_2$ для~$W_1\subseteq V_1,\ W_2\subseteq V_2$, что:
% ---
$$\begin{cases}
\langle\text{root}_{T_1},\text{root}_{T_2}\rangle\in M\neq\emptyset\\
\langle\text{parent}_v,\text{parent}_w\rangle\in M\iff\langle v,w\rangle\in M\\
v_2=\text{next}_{v_1},\ w_2=\text{next}_{w_1}\iff\langle v_1,w_1\rangle,\langle v_2,w_2\rangle\in M
\end{cases}$$
% ---
{\ital Лемма.} Пусть $M$ --- отображение $T_1$ в $T_2$. Тогда:
% ---
$$\forall\langle v,w\rangle\in M\ \text{depth}_v=\text{depth}_w$$
% ---
{\ital Стоимость} элементарной операции над $T_1$ и $T_2$ задаётся метрикой $\gamma\colon V_1\cup V_2\cup\{\lambda\}\times V_1\cup V_2\cup\{\lambda\}\to\mathbb{R}^+_0$.

{\ital Стоимость} трансформации $T_1$ в $T_2$ {\ital\color{desc}(E)} задаётся метрикой:
% ---
$$\gamma(E)=\sum_{\langle v,w\rangle\in E}\gamma(v,w)$$
% ---
{\ital Редакционная дистанция} между $T_1$ и $T_2$ --- функция:
% ---
$$\gamma_{\text{\tinyt min}}=\text{min}(\{\gamma(E)\mid\forall E\})$$
% ---
{\ital Редакционный граф} для $T_1$ и $T_2$ --- неорграф $G=\langle V,E\rangle$ с~вершинами вида $vw$, $v\in V_1\cup\{v_0\}$, $w\in V_2\cup\{w_0\}$ {\ital\color{desc}($v_0,w_0$} {\color{desc}--- {\ital мнимые узлы)}}, рёбра которого определяются по правилу:
% ---
$$\begin{sqcases}
\text{depth}_{v_{i+1}}\geq\text{depth}_{w_{j+1}}\hspace*{-9pt}\iff\hspace*{-6pt}\langle v_iw_j,v_{i+1}w_j\rangle\in E\ {\ital\color{desc}(v_{i+1}\hspace*{-3pt}\mapsto\hspace*{-3pt}\lambda)}\\
\text{depth}_{v_{i+1}}=\text{depth}_{w_{j+1}}\hspace*{-9pt}\iff\hspace*{-6pt}\langle v_iw_j,v_{i+1}w_{j+1}\rangle\in E\ {\ital\color{desc}(v_{i+1}\hspace*{-3pt}\mapsto\hspace*{-3pt}w_{j+1})}\\
\text{depth}_{v_{i+1}}\leq\text{depth}_{w_{j+1}}\hspace*{-9pt}\iff\hspace*{-6pt}\langle v_iw_j,v_iw_{j+1}\rangle\in E\ {\ital\color{desc}(\lambda\hspace*{-3pt}\mapsto\hspace*{-3pt}w_{j+1})}
\end{sqcases}$$
% ---
{\ital Лемма.} Пусть $G$ --- редакционный граф для $T_1$ и $T_2$. Тогда маршрут $P$ от $v_0w_0$ до $v_{n_1}w_{n_2}$ задаёт трансформацию:
% ---
\begin{align*}
E=\{\langle v_{i+1},\lambda\rangle&\mid\langle v_iw_j,v_{i+1}w_j\rangle\in P\}\cup\dots\\
\dots\{\langle v_{i+1}w_{j+1}\rangle&\mid\langle v_iw_j,v_{i+1}w_{j+1}\rangle\in P\}\cup\dots\\
\dots\{\langle\lambda,w_{j+1}\rangle&\mid\langle v_iw_j,v_iw_{i+1}\rangle\in P\}
\end{align*}
% ---
Алгоритм редактирования дерева занимает $\mathcal{O}(n_1n_2)$ места, используя $\mathcal{O}(n_1n_2)$ времени. 

\subsection{Обход дерева}

{\ital Обход} дерева $T=\langle V,E\rangle$ --- биективное отображение:
% ---
$$\text{order}\colon V\to\{1,\dots,\abs{V}\}$$
% ---
{\ital Прямым} называется такой обход дерева $T=\langle V,E\rangle$, что:
% ---
$$\begin{cases}
\text{order}(\text{root}_T)=1\\
\text{order}(\text{first}_v)=\text{order}(v)+1,\ \text{first}_v\neq\emptyset\\
\text{order}(\text{next}_v)=\text{order}(v)+\text{size}(v),\ \text{next}_v\neq\emptyset
\end{cases}$$
% ---
Алгоритм прямого обхода дерева занимает линейное место, используя линейное время.
