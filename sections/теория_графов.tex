\section{Теория графов}

\subsection{Ориентированный граф}

{\bold Граф} {\ital (ориентированный граф или орграф)} --- упорядо"=ченная пара $G=\langle V,E\rangle$, где

$V$ --- непустое множество {\ital вершин {\color{desc}(узлов)}};\\
$E$ --- конечное множество {\ital рёбер}, $E\subseteq V\times V$.

{\bold Порядок} графа --- число его вершин.

{\bold Размер} графа --- число его рёбер.

Ребро $e=\langle v,\ w\rangle$ задаётся вершинами $v,\ w$, где $v$ --- начало ребра, а $w$ --- его конец; вершины $v,\ w$ являются {\ital соседними}.

{\bold Входящая} {\ital валентность} вершины $v$ графа $G$ --- число рёбер, чей конец в $v$:
% ---
$$\text{indeg}(v)=\abs{\{\langle u,v\rangle\mid\langle u,v\rangle\in E\}}$$
% ---
{\bold Исходящая} {\ital валентность} вершины $v$ графа $G$ --- число рёбер, чьё начало в $v$:
% ---
$$\text{outdeg}(v)=\abs{\{\langle v,u\rangle\mid\langle v,u\rangle\in E\}}$$
% ---
{\bold Валентность} вершины $v$ графа $G$ --- сумма входящей и~исходящей валентностей вершины:
% ---
$$\text{deg}(v)=\text{indeg}(v)+\text{outdeg}(v)$$
% ---
\begin{theorem}
{\bold Свойство.} Пусть $G=\langle V,E\rangle$ --- граф с $n$ вершинами и $m$ рёбрами. Тогда:
% ---
$$\sum_{i=1}^{n}\text{indeg}(v_i)=\sum_{i=1}^{n}\text{outdeg}(v_i)=m$$
\end{theorem}
% ---
{\bold Подграф} $G=\langle V,E\rangle$, {\ital порождённый} на $W\subset V$, --- граф вида
% ---
$$G_W=\langle W,E\cap W\times W\rangle.$$

\newpage
\subsection{Неориентированный граф}

{\bold Неорграф} {\ital (неориентированный граф)} --- такой граф $G=\langle V,E\rangle$, что:
% ---
$$\forall v,w\in V\ \langle v,w\rangle\in E\implies\langle w,v\rangle\in E$$
% ---
{\bold Валентность} вершины $v$ неорграфа --- число рёбер, которые связаны с $v$.

{\bold Кратными} называются два и более рёбер, которые образо"=ваны {\ital одинаковыми} вершинами.

\subsection{Последовательность вершин}

{\bold Путь} от вершины $v_i$ до вершины $v_j$ графа $G$ --- последо"=вательность вершин или рёбер:
% ---
$$\begin{cases*}
&\begin{sqcases*}
&[v_i,v_{i+1},\dots,v_{j-1},v_j]\text{ вершины}\\
&[e_i,e_{i+1},\dots,e_{j-1},e_j]\text{ рёбра}
\end{sqcases*}\\
&e_k=\langle v_{k-1},v_k\rangle,k\in\{i+1,\dots,j\}
\end{cases*}$$
% ---
{\bold Закрытым} называется такой путь, где начальная и~конечная вершины совпадают.

{\bold Цепь} --- путь без повтора рёбер.

{\bold Простая цепь} --- путь без повтора рёбер и вершин {\ital\color{desc} (кроме, возможно, первой и~последней вершины)}.

{\bold Цикл} --- закрытая простая цепь.

{\bold Паросочетание} --- множество попарно несмежных рёбер.

{\bold Эйлеровой} называется такая последовательность вершин, которая проходит по всем {\ital рёбрам} графа.
% ---
\begin{theorem}
{\bold Критерий эйлеровости.} Связный неорграф {\ital эйлеров}, если валентность всех его вершин чётна. 
\end{theorem}
% ---
\begin{theorem}
{\bold Критерий полуэйлеровости.} Связный неорграф {\ital полуэйлеров}, если:

\begin{list*}
\item валентность всеъ вершин {\ital чётна};
\item ноль или две вершины имеют {\ital нечётную} валентность.
\end{list*}
\end{theorem}
% ---
{\bold Ациклическим {\ital (лесом)}} называется граф без циклов.

\subsection{Виды графов}

{\bold Полным} называется такой неорграф $G=\langle V,E\rangle$, что:
% ---
$$E=V\times V$$
% ---
{\bold Однородным} называется такой неорграф, у которого {\ital валентности} всех вершин равны.

{\bold Транспонированным} называется такой граф $G^T$ по отно"=шению к $G$, у которого все рёбра {\ital инвертированы}.

{\bold Взвешенным} называется такой граф, в котором каждому ребру сопоставляется число --- {\ital вес, длина, стоимость}.

\subsection{Связность}

{\bold Связный:}
% ---
\begin{list*}
\item{\ital неорграф}, между любыми вершинами которого есть маршрут;
\item{\ital орграф}, у которого аналогичный неорграф {\ital связный}.
\end{list*}
% ---
{\bold Сильно связным} называется такой {\ital орграф} $G=\langle V,E\rangle$, что:
% ---
$$\forall v,w\in V\ \exists
\begin{cases}
\text{маршрут от }v\text{ до }w\\
\text{маршрут от }w\text{ до }v
\end{cases}$$
% ---
{\bold Точка сочленения} --- вершина, удаление которой делает граф {\ital несвязным}.

{\bold Мост} --- ребро, удаление которого делает граф {\ital несвязным}.

{\bold Компонента связности} {\ital неорграфа} --- связный подграф, который не входит в состав такого же подграфа.

{\bold Компонента сильной связности} {\ital орграфа} --- сильно связный подграф, который не входит в состав такого же подграфа.

\subsection{Дерево}

{\bold Свободное дерево} $T$ --- компонента связности леса.
% ---
\begin{theorem}
{\bold Свойство.} Пусть $T=\langle V,E\rangle$. Тогда $\abs{E}=\abs{V}-1$.
\end{theorem}
% ---
{\bold Поддерево} $T=\langle V,E\rangle$, {\ital порождённое} на $W\subset V$, --- дерево вида:
% ---
$$T_W=\langle W,E\cap W\times W\rangle$$
% ---
{\bold Корневое дерево} {\ital (ориентированное дерево или ордерево)} --- такой орграф, у которого:
% ---
\begin{list*}
\item аналогичный неорграф есть свободное дерево;
\item есть {\bold корень} --- единственная вершина с нулевой входя"=щей валентностью.
\end{list*}

{\bold Остовное дерево} --- ациклический связный подграф неорграфа, в который входят все его вершины.

{\bold Минимальным} называется такое {\ital остовное дерево}, которое обладает минимальным суммарным весом всех рёбер.

\subsection{Вершины дерева}

Пусть $T$ --- корневое дерево, причём $\langle v,w\rangle\in E_T$:

\begin{list*}
\item{\bold родитель} вершины $w$ --- это $v=:$ parent$_w$;
\item{\bold ребёнок} вершины $v$ --- это $w\in$ children$_v$.
\end{list*}

{\bold Корневым} называется узел без родителей {\ital (с нулевой входящей валентностью)}.

{\bold Листовым} называется узел без детей {\ital (с нулевой исходящей валентностью)}.

{\bold Сиблинги} --- вершины с общими родителями.

{\bold Уровень} вершины $v$ --- длина простой цепи от root$_T$ до $v$:
% ---
$$\text{depth}_v\text{ --- обозначение}$$

\subsection{Рёбра леса}

Пусть $G=\langle V,E\rangle$ --- лес:

\begin{list*}
\item{\bold обратное} ребро соединяет вершину с её {\ital предком};
\item{\bold прямое} ребро соединяет вершину с её {\ital потомком};
\item{\bold перекрёстное} ребро принадлежит множеству $V\times V\backslash E$.
\end{list*}

{\bold Безопасным} называется ребро, которое принадлежит {\ital минимальному остовному дереву}.

\subsection{Способы представления графа}

{\bold Матрица смежности} для $G=\langle V,E\rangle$ --- булева матрица $V^2$, элементы которой равны логическому значению выражения:
% ---
$$\langle v,w\rangle\in E\mid v,w\in V$$
% ---
Матрица занимает $\mathcal{O}(V^2)$ места; проверка смежности прохо"=дит за $\mathcal{O}(1)$.

{\bold Список смежности} --- хеш-таблица вида:
% ---
$$\text{вершина }\mapsto\text{ смежные узлы}$$
% ---
Список занимает $\mathcal{O}(\abs{V}+\abs{E})$ места; проверка смежности проходит за $\mathcal{O}(\text{outdeg}(v))$.

\subsection{Способы представления дерева}

{\bold Массив родителей} --- хеш-таблица вида:
% ---
$$v\mapsto\text{children}_v$$
% ---
Массив занимает $\mathcal{O}(\abs{V})$ места; вывод родителя и порядка дерева проходят за $\mathcal{O}(1)$.

{\bold «Первый ребёнок, следующий сиблинг»} --- хеш-таблица вида:
% ---
$$v\mapsto\langle\text{first}_v,\text{next}_v\rangle$$
% ---
{\ital Первый} в памяти ребёнок узла $v$ --- first$_v$, {\ital последний} --- $\text{last}_v$; {\ital следующий} в памяти родственник узла $v$ --- next$_v$.

Массив занимает $\mathcal{O}(\abs{V})$ места; вывод первого ребёнка, следу"=ющего родственника и порядка дерева проходят за $\mathcal{O}(1)$.

\subsection{Редактирование дерева}

К {\bold элементарным операциям} редактирования дерева относятся:

--- {\ital удаление} листового узла $v$ с ребром $\langle\text{parent}_v,v\rangle$: $v\mapsto\lambda$;\\
--- {\ital вставка} листового узла $v$ с ребром $\langle\text{parent}_v,v\rangle$: $\lambda\mapsto v$;\\
--- {\ital замещение} вершины $v$ другой вершиной $w$: $v\mapsto w$.

Пусть $T_1=\langle V_1,E_1\rangle$, $T_2=\langle V_2,E_2\rangle$ --- корневые деревья.

{\ital Трансформация} $T_1$ в $T_2$ --- упорядоченное биективное отображение $E\subseteq V_1\cup\{\lambda\}\times V_2\cup\{\lambda\}$.

Биективное {\ital отображение} $T_1$ в $T_2$ --- такое $M\subseteq W_1\times W_2$ для~$W_1\subseteq V_1,\ W_2\subseteq V_2$, что:
% ---
$$\begin{cases}
\langle\text{root}_{T_1},\text{root}_{T_2}\rangle\in M\neq\emptyset\\
\langle\text{parent}_v,\text{parent}_w\rangle\in M\iff\langle v,w\rangle\in M\\
v_2=\text{next}_{v_1},\ w_2=\text{next}_{w_1}\iff\langle v_1,w_1\rangle,\langle v_2,w_2\rangle\in M
\end{cases}$$
% ---
{\ital Лемма.} Пусть $M$ --- отображение $T_1$ в $T_2$. Тогда:
% ---
$$\forall\langle v,w\rangle\in M\ \text{depth}_v=\text{depth}_w$$
% ---
{\ital Стоимость} элементарной операции над $T_1$ и $T_2$ задаётся метрикой $\gamma\colon V_1\cup V_2\cup\{\lambda\}\times V_1\cup V_2\cup\{\lambda\}\to\mathbb{R}^+_0$.

{\ital Стоимость} трансформации $T_1$ в $T_2$ {\ital\color{desc}(E)} задаётся метрикой:
% ---
$$\gamma(E)=\sum_{\langle v,w\rangle\in E}\gamma(v,w)$$
% ---
{\ital Редакционная дистанция} между $T_1$ и $T_2$ --- функция:
% ---
$$\gamma_{\text{\tinyt min}}=\text{min}(\{\gamma(E)\mid\forall E\})$$
% ---
{\ital Редакционный граф} для $T_1$ и $T_2$ --- неорграф $G=\langle V,E\rangle$ с~вершинами вида $vw$, $v\in V_1\cup\{v_0\}$, $w\in V_2\cup\{w_0\}$ {\ital\color{desc}($v_0,w_0$} {\color{desc}--- {\ital мнимые узлы)}}, рёбра которого определяются по правилу:
% ---
$$\begin{sqcases*}
&\text{depth}_{v_{i+1}}\geq\text{depth}_{w_{j+1}}\hspace*{-9pt}\iff\hspace*{-6pt}\langle v_iw_j,v_{i+1}w_j\rangle\in E\ {\ital\color{desc}(v_{i+1}\hspace*{-3pt}\mapsto\hspace*{-3pt}\lambda)}\\
&\text{depth}_{v_{i+1}}=\text{depth}_{w_{j+1}}\hspace*{-9pt}\iff\hspace*{-6pt}\langle v_iw_j,v_{i+1}w_{j+1}\rangle\in E\ {\ital\color{desc}(v_{i+1}\hspace*{-3pt}\mapsto\hspace*{-3pt}w_{j+1})}\\
&\text{depth}_{v_{i+1}}\leq\text{depth}_{w_{j+1}}\hspace*{-9pt}\iff\hspace*{-6pt}\langle v_iw_j,v_iw_{j+1}\rangle\in E\ {\ital\color{desc}(\lambda\hspace*{-3pt}\mapsto\hspace*{-3pt}w_{j+1})}
\end{sqcases*}$$
% ---
{\ital Лемма.} Пусть $G$ --- редакционный граф для $T_1$ и $T_2$. Тогда маршрут $P$ от $v_0w_0$ до $v_{n_1}w_{n_2}$ задаёт трансформацию:
% ---
\begin{align*}
E=\{\langle v_{i+1},\lambda\rangle&\mid\langle v_iw_j,v_{i+1}w_j\rangle\in P\}\cup\dots\\
\dots\{\langle v_{i+1}w_{j+1}\rangle&\mid\langle v_iw_j,v_{i+1}w_{j+1}\rangle\in P\}\cup\dots\\
\dots\{\langle\lambda,w_{j+1}\rangle&\mid\langle v_iw_j,v_iw_{i+1}\rangle\in P\}
\end{align*}
% ---
Алгоритм редактирования дерева занимает $\mathcal{O}(n_1n_2)$ места, используя $\mathcal{O}(n_1n_2)$ времени. 

\subsection{Обход дерева}

{\ital Обход} дерева $T=\langle V,E\rangle$ --- биективное отображение:
% ---
$$\text{order}\colon V\to\{1,\dots,\abs{V}\}$$
% ---
{\ital Прямым} называется такой обход дерева $T=\langle V,E\rangle$, что:
% ---
$$\begin{cases}
\text{order}(\text{root}_T)=1\\
\text{order}(\text{first}_v)=\text{order}(v)+1,\ \text{first}_v\neq\emptyset\\
\text{order}(\text{next}_v)=\text{order}(v)+\text{size}(v),\ \text{next}_v\neq\emptyset
\end{cases}$$
% ---
Алгоритм прямого обхода дерева занимает линейное место, используя линейное время.
